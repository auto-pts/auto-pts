#
# auto-pts - The Bluetooth PTS Automation Framework
#
# Copyright (c) 2017, Intel Corporation.
#
# This program is free software; you can redistribute it and/or modify it
# under the terms and conditions of the GNU General Public License,
# version 2, as published by the Free Software Foundation.
#
# This program is distributed in the hope it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
# more details.
#

"""GATT test cases"""

try:
    from ptsprojects.testcase import TestCase, TestCmd, TestFunc, \
        TestFuncCleanUp, MMI
    from ptsprojects.zephyr.ztestcase import ZTestCase

except ImportError:  # running this module as script
    import sys
    sys.path.append("../..")  # to be able to locate the following imports

    from ptsprojects.testcase import TestCase, TestCmd, TestFunc, \
        TestFuncCleanUp, MMI
    from ptsprojects.zephyr.ztestcase import ZTestCase

import btp
from time import sleep
import logging


class UUID:
    gap_svc = '1800'
    gatt_svc = '1801'
    CEP = '2900'
    CUD = '2901'
    CCC = '2902'
    SCC = '2903'
    CPF = '2904'
    CAF = '2905'
    device_name = '2A00'
    appearance = '2A01'
    service_changed = '2A05'
    battery_level = '2A19'
    date_of_birth = '2A85'
    gender = '2A8C'
    VND16_1 = 'AA50'
    VND16_2 = 'AA51'
    VND16_3 = 'AA52'
    VND16_4 = 'AA53'
    VND16_5 = 'AA54'
    VND128_1 = 'F000BB5004514000B123456789ABCDEF'
    VND128_2 = 'F000BB5104514000B123456789ABCDEF'
    VND128_3 = 'F000BB5204514000B123456789ABCDEF'


class Addr:
    le_public = 0
    le_random = 1

class Value:
    one_byte = '01'
    two_bytes = '0123'
    eight_bytes_1 = '0123456789ABCDEF'
    eight_bytes_2 = 'FEDCBA9876543210'
    long_1 = eight_bytes_1 * 4
    long_2 = eight_bytes_2 * 4


class IOCap:
    display_only = 0
    display_yesno = 1
    keyboard_only = 2
    no_input_output = 3


def decode_flag_name(flag, names_dict):
    """Returns string description that corresponds to flag"""

    decoded_str = ""
    sep = ", "

    for named_flag in sorted(names_dict.keys()):
        if (flag & named_flag) == named_flag:
            decoded_str += names_dict[named_flag] + sep

    if decoded_str.endswith(sep):
        decoded_str = decoded_str.rstrip(sep)

    return decoded_str


class Prop:
    """Properties of characteresic

    Specified in BTP spec:

    Possible values for the Properties parameter are a bit-wise of the
    following bits:

    0       Broadcast
    1       Read
    2       Write Without Response
    3       Write
    4       Notify
    5       Indicate
    6       Authenticated Signed Writes
    7       Extended Properties

    """
    broadcast     = 2 ** 0
    read          = 2 ** 1
    write_wo_resp = 2 ** 2
    write         = 2 ** 3
    nofity        = 2 ** 4
    indicate      = 2 ** 5
    auth_swrite   = 2 ** 6
    ext_prop      = 2 ** 7

    names = {
        broadcast     : "Broadcast",
        read          : "Read",
        write_wo_resp : "Write Without Response",
        write         : "Write",
        nofity        : "Notify",
        indicate      : "Indicate",
        auth_swrite   : "Authenticated Signed Writes",
        ext_prop      : "Extended Properties",
    }

    @staticmethod
    def decode(prop):
        return decode_flag_name(prop, Prop.names)


class Perm:
    """Permission of characteresic or descriptor

    Specified in BTP spec:

    Possible values for the Permissions parameter are a bit-wise of the
    following bits:

    0       Read
    1       Write
    2       Read with Encryption
    3       Write with Encryption
    4       Read with Authentication
    5       Write with Authentication
    6       Authorization

    """
    read        = 2 ** 0
    write       = 2 ** 1
    read_enc    = 2 ** 2
    write_enc   = 2 ** 3
    read_authn  = 2 ** 4
    write_authn = 2 ** 5
    read_authz  = 2 ** 6
    write_authz = 2 ** 7

    names = {
        read        : "Read",
        write       : "Write",
        read_enc    : "Read with Encryption",
        write_enc   : "Write with Encryption",
        read_authn  : "Read with Authentication",
        write_authn : "Write with Authentication",
        read_authz  : "Read with Authorization",
        write_authz : "Write with Authorization"
    }

    @staticmethod
    def decode(perm):
        return decode_flag_name(perm, Perm.names)

def verify_gatt_sr_gpa_bv_04_c(description):
    """Verification function for GATT/SR/GPA/BV-04-C

    Verification is a bit trickier with GATT/SR/GPA/BV-04-C, PTS can ask to
    verify different things between different test case executions. PTS can
    ask:

    1) Please confirm IUT contain: Attribute Handle = '0004'O
       Properties = '02'O,Handle = '0005'O,UUID = '2A01'O

    2) Please confirm IUT contain: Attribute Handle = '0002'O
       Properties = '02'O,Handle = '0003'O,UUID = '2A00'O

    Ideally, handle properties and UUID would be read by auto-pts from the
    IUT. For now support for multiple tuple of strings to verify is
    implemented in this function. The logical operator between the tuples of
    strings is OR. That is, for the total verification to pass verification of
    one of the tuples must pass.

    """
    logging.debug("Verifying %r", description)
    verification_pass = False

    verify = (
        ("Attribute Handle = '0004'",
         "Properties = '02'",
         "Handle = '0005'",
         "UUID = '%s'" % UUID.appearance),

        ("Attribute Handle = '0002'",
         "Properties = '02'",
         "Handle = '0003'",
         "UUID = '%s'" % UUID.device_name))

    for verify_tuple in verify:
        logging.debug("tuple to verify %r", verify_tuple)

        for text in verify_tuple:
            logging.debug("Verifying: %r", text)
            if text.upper() not in description.upper():
                logging.debug("Verifying fail: %s", text)
                break # for text in verify_tuple
        else:
            logging.debug("Verifying pass")
            verification_pass = True

        if verification_pass:
            break

    logging.debug("Verification pass: %s", verification_pass)
    return verification_pass

def test_cases_server(pts):
    """Returns a list of GATT Server test cases"""

    pts_bd_addr = pts.q_bd_addr

    pre_conditions=[TestFunc(btp.core_reg_svc_gap),
                    TestFunc(btp.gap_read_ctrl_info),
                    TestFunc(btp.wrap, pts.update_pixit_param,
                             "GATT", "TSPX_bd_addr_iut",
                             btp.get_stored_bd_addr),
                    TestFunc(btp.core_reg_svc_gatts),
                    TestFunc(btp.gap_set_conn),
                    TestFunc(btp.gap_set_gendiscov)]

    test_cases = [
        ZTestCase("GATT", "GATT/SR/GAC/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.eight_bytes_1 * 10),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAD/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={17: ("Service = " + UUID.VND16_1)}),
        ZTestCase("GATT", "GATT/SR/GAD/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={23: ("UUID= '%s" % UUID.gap_svc,
                                    "start handle = '0001'",
                                    "end handle = '0005'")}),
        ZTestCase("GATT", "GATT/SR/GAD/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_add_svc, 0, UUID.VND16_3),
                   TestFunc(btp.gatts_add_inc_svc, 1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={24: ("Attribute Handle = '000E'",
                                    "Included Service Attribute handle = '000A'",
                                    "End Group Handle = '000C'",
                                    "Service UUID = '%s'" % UUID.VND16_1)}),
        ZTestCase("GATT", "GATT/SR/GAD/BV-04-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={25: ("UUID= '%s'" % UUID.gap_svc,
                                    "handle='0002'")}),
        ZTestCase("GATT", "GATT/SR/GAD/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAD/BV-06-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read | Perm.write,
                            UUID.VND16_3),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, 0x00, 0x00, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-02-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast, Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read, Perm.read_authz,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-04-C",
                  pre_conditions +
                  [TestFunc(btp.gap_set_io_cap, IOCap.display_only),
                   TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read, Perm.read_authn,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read_enc, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_set_enc_key_size, 2, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND128_1),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-06-C",
                  edit1_wids={111: UUID.VND16_2, 110: "000C"},
                  cmds=pre_conditions +
                         [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                          TestFunc(btp.gatts_add_char, 0, 0x00, 0x00,
                                   UUID.VND16_2),
                          TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                          TestFunc(btp.gatts_start_server),
                          TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-07-C",
                  edit1_wids={119: UUID.VND16_3},
                  cmds=pre_conditions +
                         [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                          TestFunc(btp.gatts_add_char, 0,
                                   Prop.broadcast | Prop.read,
                                   Perm.read | Perm.write, UUID.VND16_2),
                          TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                          TestFunc(btp.gatts_start_server),
                          TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-08-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-09-C",
                  edit1_wids={113: UUID.VND16_2, 112: "000C"},
                  cmds=pre_conditions +
                       [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                        TestFunc(btp.gatts_add_char, 0, Prop.read,
                                 Perm.read_authz, UUID.VND16_2),
                        TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                        TestFunc(btp.gatts_start_server),
                        TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-10-C",
                  edit1_wids={115: UUID.VND16_2, 114: "000C"},
                  cmds=pre_conditions +
                       [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                        TestFunc(btp.gatts_add_char, 0, Prop.read,
                                 Perm.read_authn, UUID.VND16_2),
                        TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                        TestFunc(btp.gatts_start_server),
                        TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-11-C",
                  edit1_wids={121: "000C", 122: UUID.VND16_2},
                  cmds=pre_conditions +
                         [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                          TestFunc(btp.gatts_add_char, 0, Prop.read,
                                   Perm.read_enc, UUID.VND16_2),
                          TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                          TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                          TestFunc(btp.gatts_start_server),
                          TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-04-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Please confirm IUT Handle='c'",
                                    "value='" + Value.long_1 + "'")}),
        ZTestCase("GATT", "GATT/SR/GAR/BI-12-C",
                  edit1_wids={110: "000C"},
                  cmds=pre_conditions +
                         [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                          TestFunc(btp.gatts_add_char, 0, 0x00, 0x00,
                                   UUID.VND16_2),
                          TestFunc(btp.gatts_set_val, 0, Value.long_1),
                          TestFunc(btp.gatts_start_server),
                          TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-13-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-14-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write | Prop.nofity,
                               Perm.read | Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-15-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read, Perm.read_authz,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-16-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read, Perm.read_authn,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-17-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read_enc, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={56: ("Please confirm IUT Handle pair",
                                    "0005", "0003",
                                    # value:
                                    # 0000 appearance
                                    # 5A6570687972 device name (Zephyr)
                                    "value='00005A6570687972'")}),
        ZTestCase("GATT", "GATT/SR/GAR/BI-18-C",
                  edit1_wids={110: "000C"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.write, Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write | Prop.nofity,
                               Perm.read | Perm.write, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-19-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.write, Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write | Prop.nofity,
                               Perm.read | Perm.write, UUID.VND16_4),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write | Prop.nofity,
                               Perm.read | Perm.write, UUID.VND16_5),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-20-C",
                  edit1_wids={123: "0003", 124: "0005"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read_authz, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write,
                               Perm.read | Perm.write, UUID.VND16_4),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-21-C",
                  edit1_wids={123: "0003", 124: "0005"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read_authn, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read | Prop.write,
                               Perm.read | Perm.write, UUID.VND16_4),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-22-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.appearance),
                   TestFunc(btp.gatts_set_val, 0, '0512'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read,
                            Perm.read_enc, UUID.gender),
                   TestFunc(btp.gatts_set_val, 0, '01'),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.date_of_birth),
                   TestFunc(btp.gatts_set_val, 0, '20151124'),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.battery_level),
                   TestFunc(btp.gatts_set_val, 0, '10'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-06-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.eight_bytes_1),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.eight_bytes_2),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Please confirm IUT Handle='d'",
                                    "value='"+ Value.eight_bytes_2 +"'")}),
        ZTestCase("GATT", "GATT/SR/GAR/BI-23-C",
                  edit1_wids={110: "000D"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, 0x00, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-24-C",
                  edit1_wids={118: "000F"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND128_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_1),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-25-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_1),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-26-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND128_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read_authn, UUID.VND128_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-27-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read_enc, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BV-07-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Please confirm IUT Handle='d'",
                                    "value='" + Value.long_1 + "'")}),
        ZTestCase("GATT", "GATT/SR/GAR/BV-08-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Please confirm IUT Handle='d'",
                                    "value='" + Value.long_1 + "'")}),
        ZTestCase("GATT", "GATT/SR/GAR/BI-28-C",
                  edit1_wids={110: "000d"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, 0x00, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-29-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-30-C",
                  edit1_wids={118: "FFFF"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-31-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_1),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-32-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND128_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read_authn, UUID.VND128_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAR/BI-33-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read_enc, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read | Prop.write_wo_resp,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={75: ("Please confirm IUT Write characteristic handle= '000C'O value= 'BE'O",)}),
        ZTestCase("GATT", "GATT/SR/GAW/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.auth_swrite,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.eight_bytes_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.auth_swrite,
                            Perm.read | Perm.write_authn, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.eight_bytes_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-02-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast | Prop.read | Prop.write_wo_resp,
                               Perm.read | Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read, Perm.read,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-04-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_authn, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-06-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_enc, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-07-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast | Prop.read | Prop.write_wo_resp,
                               Perm.read | Perm.write, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-08-C",
                  edit1_wids={120: "0002"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast | Prop.read, Perm.read,
                               UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-09-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-11-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-12-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_authn, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-13-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_enc, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-06-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-10-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.device_name),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.appearance),
                   TestFunc(btp.gatts_set_val, 0, Value.long_2),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-14-C",
                  edit1_wids={118: "ffff"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast | Prop.read | Prop.write,
                               Perm.read | Perm.write, UUID.device_name),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-15-C",
                  edit1_wids={120: "0002"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.broadcast | Prop.read | Prop.write,
                               Perm.read, UUID.device_name),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-17-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.ext_prop,
                            Perm.read | Perm.write_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CEP),
                   TestFunc(btp.gatts_set_val, 0, '0100'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-18-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.ext_prop,
                            Perm.read | Perm.write_authn, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CEP),
                   TestFunc(btp.gatts_set_val, 0, '0100'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-19-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write_enc, UUID.device_name),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-07-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.broadcast | Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.device_name),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-08-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-20-C",
                  edit1_wids={118: "FFFF"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, 0, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-21-C",
                  edit1_wids={120: "0004"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-22-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_1),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_authz, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-23-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND128_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND128_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_authn, UUID.VND128_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-24-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_enc, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BV-09-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-25-C",
                  edit1_wids={118: "ABCD"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, 0x00, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-26-C",
                  edit1_wids={120: "0004"},
                  cmds=pre_conditions +
                     [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                      TestFunc(btp.gatts_add_char, 0,
                               Prop.read, Perm.read, UUID.VND16_2),
                      TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                      TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.VND16_3),
                      TestFunc(btp.gatts_set_val, 0, Value.long_1),
                      TestFunc(btp.gatts_start_server),
                      TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-27-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-29-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_authz, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-30-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_authn, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-31-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_enc, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_set_enc_key_size, 0, 0x0f),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-32-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-33-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-34-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.two_bytes),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAW/BI-35-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, Value.one_byte),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, Value.long_1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GAN/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.nofity | Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '00'),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.CCC),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=92),
                   TestFunc(sleep, 1, start_wid=92),
                   TestFunc(btp.gatts_set_val, 0xC, '01', start_wid=92)]),
        ZTestCase("GATT", "GATT/SR/GAI/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.indicate | Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '00'),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.CCC),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=98),
                   TestFunc(sleep, 1, start_wid=98),
                   TestFunc(btp.gatts_set_val, 0xC, '01', start_wid=98)]),
        # Service Changed is not supported
        # ZTestCase("GATT", "GATT/SR/GAS/BV-01-C",
        ZTestCase("GATT", "GATT/SR/GAT/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.indicate | Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '00'),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write, UUID.CCC),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=98),
                   TestFunc(sleep, 1, start_wid=98),
                   TestFunc(btp.gatts_set_val, 3, '01', start_wid=98)]),
        ZTestCase("GATT", "GATT/SR/GPA/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={102: ("Attribute Handle = '0001'",
                                     "Primary Service = '%s'" % UUID.VND16_1)}),
        # tester crashes:
        # https://jira.zephyrproject.org/browse/ZEP-2396
        ZTestCase("GATT", "GATT/SR/GPA/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 1, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_svc, 0, UUID.VND16_3),
                   TestFunc(btp.gatts_add_inc_svc, 1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={102: ("Attribute Handle = '0001'",
                                     "Secondary Service = '%s'" % UUID.VND16_1)}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_svc, 0, UUID.VND16_3),
                   TestFunc(btp.gatts_add_inc_svc, 1),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={102: ("Attribute Handle = '000E'",
                                     "Included Service Attribute handle = '000A'",
                                     "End Group Handle = '000C'",
                                     "Service UUID = '%s'" % UUID.VND16_1)}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-04-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={102: verify_gatt_sr_gpa_bv_04_c}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.ext_prop,
                            Perm.read | Perm.write, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CEP),
                   TestFunc(btp.gatts_set_val, 0, '0100'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Handle='d'",
                                    "value='0100'")}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-06-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read, Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CUD),
                   TestFunc(btp.gatts_set_val, 0, '73616d706c652074657874'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Handle='d'",
                                    "value='73616D706C652074657874'")}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-07-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0,
                            Prop.read | Prop.write | Prop.nofity,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read | Perm.write,
                            UUID.CCC),
                   TestFunc(btp.gatts_set_val, 0, '0000'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Handle='9'",
                                    "value='0000'")}),
        ZTestCase("GATT", "GATT/SR/GPA/BV-08-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.broadcast | Prop.read,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_desc, 0,
                            Perm.read | Perm.write_authz | Perm.write_authn,
                            UUID.SCC),
                   TestFunc(btp.gatts_set_val, 0, '0000'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={52: ("Handle='d'",
                                    "value='0000'")}),
        # PTS crashes in GUI mode with message:
        # "An internal error occurred. Please restart the PTS. Code: 0xE0434352"
        # In auto mode PTS crashes, hence the status of test case is Started
        # PTS issue #14437, #14275, TSE #7063
        ZTestCase("GATT", "GATT/SR/GPA/BV-11-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '65'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CPF),
                   TestFunc(btp.gatts_set_val, 0, '04000127010100'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_3),
                   TestFunc(btp.gatts_set_val, 0, '1234'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CPF),
                   TestFunc(btp.gatts_set_val, 0, '06001027010200'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_4),
                   TestFunc(btp.gatts_set_val, 0, '01020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CPF),
                   TestFunc(btp.gatts_set_val, 0, '08001727010300'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_5),
                   TestFunc(btp.gatts_set_val, 0, '65123401020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CAF),
                   TestFunc(btp.gatts_set_val, 0, '040007000a00'),

                   # Workaround: PTS requires 5 Aggregate Descriptors
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_5),
                   TestFunc(btp.gatts_set_val, 0, '65123401020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CAF),
                   TestFunc(btp.gatts_set_val, 0, '040007000a00'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_5),
                   TestFunc(btp.gatts_set_val, 0, '65123401020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CAF),
                   TestFunc(btp.gatts_set_val, 0, '040007000a00'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_5),
                   TestFunc(btp.gatts_set_val, 0, '65123401020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CAF),
                   TestFunc(btp.gatts_set_val, 0, '040007000a00'),
                   TestFunc(btp.gatts_add_char, 0, Prop.read | Prop.write,
                            Perm.read, UUID.VND16_5),
                   TestFunc(btp.gatts_set_val, 0, '65123401020304'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CAF),
                   TestFunc(btp.gatts_set_val, 0, '040007000a00'),

                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)]),
        ZTestCase("GATT", "GATT/SR/GPA/BV-12-C",
                  pre_conditions +
                  [TestFunc(btp.gatts_add_svc, 0, UUID.VND16_1),
                   TestFunc(btp.gatts_add_char, 0, Prop.read, Perm.read,
                            UUID.VND16_2),
                   TestFunc(btp.gatts_set_val, 0, '0000'),
                   TestFunc(btp.gatts_add_desc, 0, Perm.read, UUID.CPF),
                   TestFunc(btp.gatts_set_val, 0, '0600A327010100'),
                   TestFunc(btp.gatts_start_server),
                   TestFunc(btp.gap_adv_ind_on, start_wid=1)],
                  verify_wids={104: ("Value = '0000'",
                                     "Attribute Handle = '000D'",
                                     "Format = '06'",
                                     "Exponent = 0",
                                     "Uint = '27A3'",
                                     "Namespace = '01'",
                                     "Description = '0001'")}),
    ]

    return test_cases


def test_cases_client(pts):
    """Returns a list of GATT Client test cases

    pts -- Instance of PyPTS

    """

    pts_bd_addr = pts.q_bd_addr

    pre_conditions=[TestFunc(btp.core_reg_svc_gap),
                    TestFunc(btp.gap_read_ctrl_info),
                    TestFunc(btp.wrap, pts.update_pixit_param,
                             "GATT", "TSPX_bd_addr_iut",
                             btp.get_stored_bd_addr),
                    TestFunc(btp.core_reg_svc_gatts)]

    test_cases = [
        ZTestCase("GATT", "GATT/CL/GAC/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_exchange_mtu,
                            Addr.le_public, pts_bd_addr,
                            start_wid=12),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=69),
                   TestFunc(btp.gattc_write_long_rsp, start_wid=69),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAD/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_disc_prim_uuid,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, start_wid=18),
                   TestFunc(btp.gattc_disc_prim_uuid_rsp, True, start_wid=18),
                   TestFunc(btp.gattc_disc_prim_uuid,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, start_wid=20),
                   TestFunc(btp.gattc_disc_prim_uuid_rsp, True, start_wid=20),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={19: btp.verify_description,
                               21: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAD/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   # NOTE: We cannot discover all services at first, so we look
                   # for included at once
                   TestFunc(btp.gattc_find_included,
                            Addr.le_public, pts_bd_addr, '0001',
                            'FFFF', start_wid=15),
                   TestFunc(btp.gattc_find_included_rsp, True, start_wid=15),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={24: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAD/BV-04-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_disc_all_chrc,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_2, MMI.arg_3, start_wid=27),
                   TestFunc(btp.gattc_disc_all_chrc_rsp, True, start_wid=27),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={28: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAD/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_disc_chrc_uuid,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, MMI.arg_2, MMI.arg_3, start_wid=29),
                   TestFunc(btp.gattc_disc_chrc_uuid_rsp, True, start_wid=29),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={30: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAD/BV-06-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_disc_all_desc,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, MMI.arg_2, start_wid=31),
                   TestFunc(btp.gattc_disc_all_desc_rsp, True, start_wid=31),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={32: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BV-01-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev,
                                 pts_bd_addr, Addr.le_public,
                                 start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_val=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={50: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-01-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={40: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-02-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev,
                                 pts_bd_addr, Addr.le_public,
                                 start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={41: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-03-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=48),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={42: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-04-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp,
                                 store_rsp=True, start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={43: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-05-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={44: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BV-04-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_val=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={52: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-12-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={41: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-13-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_long,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, 1, start_wid=53),
                        TestFunc(btp.gattc_read_long_rsp, store_rsp=True,
                                 start_wid=53),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={46: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-14-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={40: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-15-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={42: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-16-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={43: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-17-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={44: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BV-05-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp,
                                 store_val=True, start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={55: btp.verify_multiple_read_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-18-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp, store_rsp=True,
                                 start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={41: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-19-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp, store_rsp=True,
                                 start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={40: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-20-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp, store_rsp=True,
                                 start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={42: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-21-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp, store_rsp=True,
                                 start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={43: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-22-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_multiple,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=57),
                        TestFunc(btp.gattc_read_multiple_rsp,
                                 store_rsp=True, start_wid=57),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={44: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BV-06-C",
                  edit1_wids={104: btp.var_get_passkey},
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_val=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={59: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-23-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={41: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-24-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={40: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-25-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={42: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-26-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={43: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-27-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={44: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BV-07-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_val=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={52: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-28-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={41: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-29-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read_long,
                                 Addr.le_public, pts_bd_addr,
                                 MMI.arg_1, MMI.arg_2, start_wid=60),
                        TestFunc(btp.gattc_read_long_rsp, store_rsp=True,
                                 start_wid=60),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={46: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-30-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={40: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-31-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={42: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-32-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={43: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-33-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=58),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=58),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={44: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAR/BI-35-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_read, Addr.le_public,
                                 pts_bd_addr, MMI.arg_1, start_wid=48),
                        TestFunc(btp.gattc_read_rsp, store_rsp=True,
                                 start_wid=48),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)],
                  verify_wids={47: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_without_rsp,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, '12', MMI.arg_2, start_wid=70),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_signed_write,
                            Addr.le_public, pts_bd_addr,
                            MMI.arg_1, '12', None, start_wid=72),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BV-03-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BI-02-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={61: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-03-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={62: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-04-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={63: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-05-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={64: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-06-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={65: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BV-05-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BI-07-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12' * 23, MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={61: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-08-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={62: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-09-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, MMI.arg_2, '12', None,
                            start_wid=77),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=77),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={66: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-11-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={63: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-12-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={64: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-13-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={65: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BV-08-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BI-20-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={61: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-21-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={62: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-22-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={63: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-23-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={64: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-24-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={65: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BV-09-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAW/BI-25-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0,
                            '12', 22, start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={61: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-26-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={62: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-27-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, MMI.arg_2, '12', None,
                            start_wid=77),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=77),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={66: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-29-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={63: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-30-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={64: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-31-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '12', MMI.arg_2,
                            start_wid=76),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=76),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={65: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-33-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '1234', MMI.arg_2,
                            start_wid=80),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=80),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={67: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-34-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '1234', MMI.arg_2,
                            start_wid=81),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=81),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={67: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-35-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '1234', MMI.arg_2,
                            start_wid=80),
                   TestFunc(btp.gattc_write_rsp, True, start_wid=80),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={67: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAW/BI-36-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write_long, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, 0, '1234', MMI.arg_2,
                            start_wid=81),
                   TestFunc(btp.gattc_write_long_rsp, True, start_wid=81),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)],
                  verify_wids={67: btp.verify_description}),
        ZTestCase("GATT", "GATT/CL/GAN/BV-01-C",
                  cmds=pre_conditions +
                       [TestFunc(btp.gap_conn, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=2),
                        TestFunc(btp.gattc_cfg_notify, Addr.le_public,
                                 pts_bd_addr, 1, MMI.arg_1, start_wid=91),
                        TestFunc(btp.gattc_notification_ev, pts_bd_addr,
                                 Addr.le_public, 1, start_wid=91),
                        TestFunc(btp.gap_disconn, pts_bd_addr,
                                 Addr.le_public, start_wid=3),
                        TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                 Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAI/BV-01-C",
                    cmds=pre_conditions +
                         [TestFunc(btp.gap_conn, pts_bd_addr,
                                   Addr.le_public, start_wid=2),
                          TestFunc(btp.gap_connected_ev, pts_bd_addr,
                                   Addr.le_public, start_wid=2),
                          TestFunc(btp.gattc_cfg_indicate, Addr.le_public,
                                   pts_bd_addr, 1, MMI.arg_1, start_wid=91),
                          TestFunc(btp.gattc_notification_ev, pts_bd_addr,
                                   Addr.le_public, 2, start_wid=91),
                          TestFunc(btp.gap_disconn, pts_bd_addr,
                                   Addr.le_public, start_wid=3),
                          TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                                   Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAS/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAT/BV-01-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_read, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, start_wid=48),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
        ZTestCase("GATT", "GATT/CL/GAT/BV-02-C",
                  pre_conditions +
                  [TestFunc(btp.gap_conn, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gap_connected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=2),
                   TestFunc(btp.gattc_write, Addr.le_public,
                            pts_bd_addr, MMI.arg_1, '12', MMI.arg_2,
                            start_wid=74),
                   TestFunc(btp.gap_disconn, pts_bd_addr,
                            Addr.le_public, start_wid=3),
                   TestFunc(btp.gap_disconnected_ev, pts_bd_addr,
                            Addr.le_public, start_wid=3)]),
    ]

    return test_cases


def test_cases(pts):
    """Returns a list of GATT test cases"""

    pts.update_pixit_param("GATT", "TSPX_delete_link_key", "TRUE")
    pts.update_pixit_param("GATT", "TSPX_delete_ltk", "TRUE")
    pts.update_pixit_param("GATT", "TSPX_iut_use_dynamic_bd_addr", "TRUE")

    test_cases = test_cases_client(pts)
    test_cases += test_cases_server(pts)

    return test_cases


def main():
    """Main."""
    import ptsprojects.zephyr.iutctl as iutctl

    iutctl.init_stub()

    test_cases_ = test_cases("AB:CD:EF:12:34:56")

    for test_case in test_cases_:
        print
        print test_case

        if test_case.edit1_wids:
            print "edit1_wids: %r" % test_case.edit1_wids

        if test_case.verify_wids:
            print "verify_wids: %r" % test_case.verify_wids

        for index, cmd in enumerate(test_case.cmds):
            str_cmd = str(cmd)

            if isinstance(cmd, TestFunc):
                if cmd.func == btp.gatts_add_char:
                    str_cmd += ", Properties: %s" % Prop.decode(cmd.args[1])
                    str_cmd += ", Permissions: %s" % Perm.decode(cmd.args[2])
                elif cmd.func == btp.gatts_add_desc:
                    str_cmd += ", Permissions: %s" % Perm.decode(cmd.args[1])

            print "%d) %s" % (index, str_cmd)

if __name__ == "__main__":
    main()
